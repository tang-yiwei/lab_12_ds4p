---
title: "Lab 12 - Smoking during pregnancy"
author: "Yiwei Tang"
date: "2/20/2026"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(tidymodels)
library(openintro)
data(ncbirths)
```

### Exercise 1

fage, mage, weeks, visits, gained, and weight are numerical variables. fage, mage, visits, and gained are skewed to the right with some outliers. weeks and weight are skewed to the left with outliers.

```{r summary}
summary(ncbirths)
```

```{r fage}
ncbirths %>% 
  ggplot(
    aes(
      x = fage,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```

```{r mage}
ncbirths %>% 
  ggplot(
    aes(
      x = mage,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```

```{r weeks}
ncbirths %>% 
  ggplot(
    aes(
      x = weeks,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```


```{r visits}
ncbirths %>% 
  ggplot(
    aes(
      x = visits,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```

```{r gained}
ncbirths %>% 
  ggplot(
    aes(
      x = gained,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```

```{r weight}
ncbirths %>% 
  ggplot(
    aes(
      x = weight,
    )
  ) +
  geom_boxplot() +
  theme_minimal()
```

### Exercise 2

The mean weights of infants of White mothers in the sample is 7.25 pound, which is less than the average.

```{r white_df}
ncbirths_white <- ncbirths %>% 
  filter(whitemom == "white")

mean(ncbirths_white$weight)
```

### Exercise 3

The observations in the sample are independent of each other and the sample size is reasonably large (n = 1000), and the shape of the distribution. However, the shape of the distribution is slightly skewed to the left. Therefore, I don't think the criteria necessary for conducting simulaiton-based inference are satisfied.

```{r distribution}
ncbirths_white %>% 
  ggplot(
    aes(x = weight)
  ) +
  geom_bar()
```

### Exercise 4

```{r bootstrap}
set.seed(123)

boot.data <- ncbirths_white %>%
  specify(response = weight) %>% 
  generate(reps = 15000, type = "bootstrap") %>% 
  calculate(stat = "mean")

obs_mean <- mean(ncbirths_white$weight)

boot_mean_center <- mean(boot.data$stat)

null_dist <- boot.data %>%
  mutate(null_stat = stat - boot_mean_center + 7.43)

null_dist %>% 
  ggplot(
    aes(
      x = null_stat)
    ) +
  geom_histogram(fill = "#9ecae1") +
  labs(title = "Bootstrap distribution of means",
       x = "Mean",
       y = "") +
  geom_vline(aes(
    xintercept = obs_mean
  ),
    color = "#3182bd",
    linetype = "dashed")
```

```{r p-value}
p_value <- null_dist %>%
  summarise(p = mean(abs(null_stat - 7.43) >= 
                     abs(obs_mean - 7.43))) %>%
  pull(p)

p_value
```

The p-value is less than 0.001, which supports the alternative hypothesis that the baby weight in the sample is significantly lower than that of the population.

### Exercise 5

```{r habit_weight}
ncbirths %>%
  filter(!is.na(habit),
         !is.na(weight)) %>%
  ggplot(aes(
    x = habit, 
    y = weight)) +
  geom_boxplot(fill = "#9ecae1",
               alpha = 0.8,
               width = 0.6) +
  labs(title = "Birth Weight by Mother's Smoking Habit",
    x = "Smoking Habit",
    y = "Birth Weight (lbs)"
  ) +
  theme_minimal()

```

The boxplots show that birth weights for babies of smoking mothers tend to be lower than those of non-smoking mothers. The median weight for smokers is visibly lower, although the spreads of the two groups are fairly similar and the distributions overlap considerably. Both groups show slight skewness and some potential outliers. While there appears to be a difference in center, formal statistical testing is needed to determine whether this difference is statistically significant.

### Exercise 6

```{r clean}
ncbirths_clean <- ncbirths %>%
  filter(!is.na(habit), !is.na(weight))
```

It is important to remove rows with missing values in either habit or weight before calculating group summaries because missing values can distort results. Observations without a smoking status cannot be assigned to a group, and observations without a birth weight cannot contribute to the calculation of group means. Removing incomplete cases ensures that comparisons between groups are based only on valid and comparable data.

### Exercise 7

```{r diff}
ncbirths_clean %>%
  group_by(habit) %>%
  summarise(mean_weight = mean(weight))

obs_diff <- ncbirths_clean %>%
  group_by(habit) %>%
  summarise(mean_weight = mean(weight)) %>%
  summarise(diff = diff(mean_weight)) %>%
  pull(diff)

obs_diff
```

The observed difference in mean birth weight between babies born to non-smoking and smoking mothers is approximately 0.3 pounds. On average, babies of non-smoking mothers weigh more than those of smoking mothers.

### EXercise 8

Let $\mu_1$ represent the mean birth weight for babies born to non-smoking mothers, 
and $\mu_2$ represent the mean birth weight for babies born to smoking mothers.

**Null Hypothesis:** There is no difference in birth weight between the two groups.
$$
H_0: \mu_1 - \mu_2 = 0
$$

**Alternative Hypothesis:** There is a difference in mean birth weight between the two groups.
$$
H_A: \mu_1 - \mu_2 \neq 0
$$

### Exercise 9

```{r test}
ttest <- t.test(weight ~ habit, data = ncbirths_clean, alternative = "two.sided")
ttest
```

I am honestly very confused at this point. I am not sure what I should be doing for this exercise. And it has taken me way too long to get to this point. I think it might be a good place for me to stop and spend the time I have to think more about what bootstrapping is doing and how that's different from inferential analysis.